<!DOCTYPE HTML>
<html lang="en">
	<head>
		<title>OPSEC for Blue Teams - Losing Defender's Advantage - MB Secure</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes" />
		<meta name="description" content="Part 1 of the OPSEC for Blue Teams series covering the risk of alerting adversaries and OPSEC for getting context and OSINT on domains and IPs." />
		
		<!-- Open Graph -->
		<meta property="og:title" content="OPSEC for Blue Teams - Losing Defender's Advantage - MB Secure" />
		<meta property="og:description" content="Part 1 of the OPSEC for Blue Teams series covering the risk of alerting adversaries and OPSEC for getting context and OSINT on domains and IPs." />
		<meta property="og:type" content="article" />
		<meta property="og:url" content="https://mbsecure.nl/blog/2018/9/opsec-for-blue-teams-part-1.html" />
		<link rel="canonical" href="https://mbsecure.nl/blog/2018/9/opsec-for-blue-teams-part-1.html" />
		<meta property="article:published_time" content="2018-09-26" />
		<meta property="article:author" content="Marcus Bakker" />
		
		<!-- RSS Autodiscovery -->
		<link rel="alternate" type="application/rss+xml" title="MB Secure Blog RSS Feed" href="../../../blog/feed.xml" />
		
		<link rel="icon" type="image/x-icon" href="../../../images/favicon.ico" />
		
		<!-- Structured Data -->
		<script type="application/ld+json">
		{
			"@context": "https://schema.org",
			"@type": "BlogPosting",
			"headline": "OPSEC for Blue Teams - Losing Defender's Advantage",
			"datePublished": "2018-09-26",
			"dateModified": "2018-09-26",
			"author": {
				"@type": "Person",
				"name": "Marcus Bakker",
				"url": "https://www.linkedin.com/in/marcusbakker"
			},
			"publisher": {
				"@type": "Organization",
				"name": "MB Secure",
				"logo": {
					"@type": "ImageObject",
					"url": "https://mbsecure.nl/images/logo.png"
				}
			},
			"description": "Part 1 of the OPSEC for Blue Teams series covering the risk of alerting adversaries and OPSEC for getting context and OSINT on domains and IPs."
		}
		</script>
		
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&family=Open+Sans+Condensed:wght@700&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="../../../assets/css/fontawesome-all.min.css" />
		<link rel="stylesheet" href="../../../assets/css/main.css" />
	</head>
	<body class="blog-post-page">
		<div id="page-wrapper">

			<!-- Header -->

			<!-- Nav -->
				<nav id="nav" aria-label="Main navigation">
					<!-- Nav injected by nav.js -->
				</nav>

			<main id="main-content">
				<!-- Blog Post -->
				<article class="blog-post spa-section">
					<div class="container">
						<header class="blog-post-header">
							<div class="blog-meta">
								<span class="blog-date">26 September 2018</span>
							</div>
							<h1>OPSEC for Blue Teams - Losing Defender's Advantage</h1>
						</header>

						<div class="blog-post-content">
							<p class="lead">This is a three-part blog about OPSEC for Blue Teams. This first part expresses some of my ideas about the risk of alerting the adversary and OPSEC for getting OSINT and context on domains and IPs. The <a href="../../../blog/2018/9/opsec-for-blue-teams-part-2.html">second part</a> is about testing tools (I performed tests on PassiveTotal and VirusTotal) which provide context and/or OSINT in relation to OPSEC. The <a href="../../../blog/2018/9/opsec-for-blue-teams-part-3.html">last part</a> will be on sandboxes, secure communications and sharing of info &amp; data when dealing with a targeted attack.</p>

							<p>When talking about adversaries in this series, I mean the ones which are targeting your company. So I do not discuss a threat actor executing a malware or phishing campaign against a large and diverse group of victims. You can be less strict on following certain OPSEC rules when you know you deal with a non-targeted attack. Still, following secure practices in both cases will make sure your default behaviour is in line with good OPSEC rules.</p>

							<ul>
								<li>Part 2: <a href="../../../blog/2018/9/opsec-for-blue-teams-part-2.html">OPSEC for Blue Teams - Testing PassiveTotal &amp; VirusTotal</a></li>
								<li>Part 3: <a href="../../../blog/2018/9/opsec-for-blue-teams-part-3.html">OPSEC for Blue Teams - Sandboxes &amp; Secure Communications</a></li>
							</ul>

							<h2>The Risk of Alerting the Adversary</h2>

							<p>You have an advantage as a defender when you found a trace of a targeted attack. This is called defender's advantage or the intruder's dilemma:</p>

							<blockquote>
								<p>The attacker needs to hide all his traces, but the defender needs to just find one trace to unravel the intrusion.</p>
							</blockquote>

							<p>Use this advantage to get a complete picture of the attack and take at once all actions necessary to flush out the adversary.</p>

							<p>Among others, OSINT and sandboxes allow the execution of practices producing signals telling the adversary the blue team is onto them. Obviously, that is not a good thing and you can lose defender's advantage. Based on the type (one signal is stronger than the other) and/or number of signals the adversary picks up, they will take action to make sure not losing access to your IT infrastructure. Changing the malware installed on endpoints to prevent detection, replace the current C2 domain and IP with a new one, spread to more systems or deliberately go silent for a while or change techniques to prevent being detected a second time. They may have made a mistake from which they have learned and will not make the second time.</p>

							<h2>OPSEC for Getting Context and OSINT</h2>

							<p>There are many cases in which you need more info about a domain name or IP address. Many tools and third-party services are available which can help you in getting context (whois data, passive DNS, autonomous system number, etc.) and/or OSINT. Make sure you know what your tools are doing in the background. For domains and IPs you do not want them to do any of the following actions by default:</p>

							<ul>
								<li>Setting up a connection to the domain or IP to perform an analysis.</li>
								<li>Active DNS resolution on the domain.</li>
							</ul>

							<p>These activities leave signals that can be picked up by the adversary. Imagine an adversary is using the following domain for its C2 server: <code>apiv2.attacker.com</code>. They would only expect their malware to contact to this domain. The adversary could monitor for example on the following related to <code>apiv2.attacker.com</code>:</p>

							<ul>
								<li>DNS resolutions for this domain:
									<ul>
										<li>The source IP of the DNS request is within a subnet which has no close relation to the company you are attacking.</li>
										<li>The source IP belongs to a security vendor such as VirusTotal.</li>
									</ul>
								</li>
								<li>Seeing HTTP requests that are not in line with what you expect to receive from your malware on this domain: abnormal User-Agent, unknown URL paths, signs of scanning activity, etc.</li>
							</ul>

							<p>Regarding DNS, use passive DNS for which there are many sources. When dealing with a targeted attack, third party passive DNS sources will not be of any help. Use what you already have, such as DNS logs. When you do need to perform a DNS lookup, perform the query from a company system. The reason you are doing this in the first place, is that an IP can help you in providing additional context and OSINT. Be aware though to only perform DNS queries on domains you have seen, do not start guessing domain names by querying for example <code>apiv1.attacker.com</code> till <code>apiv5.attacker.com</code>. This is a signal that can be picked up by the adversary.</p>

							<p>The main message I want to provide here: be as passive as possible when using tools and performing manual actions. In addition, when you send out signals, they have to look as normal as possible and correspond with what the adversary expects to see.</p>
						</div>

						<!-- Prev/Next Navigation -->
						<nav class="blog-post-nav" aria-label="Blog post navigation">
							<a href="../../../blog/2018/9/opsec-for-blue-teams-part-2.html" class="prev"><span class="arrow">←</span> OPSEC for Blue Teams - Part 2</a>
							<a href="../../../blog/2018/7/bypass-client-side-generated-http-security-headers.html" class="next">Bypass client-side generated HTTP security headers <span class="arrow">→</span></a>
						</nav>

						<footer class="blog-post-footer">
							<a href="../../../blog/feed.xml" class="blog-rss-link">
								<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"/></svg>
								Blog RSS
							</a>
						</footer>
					</div>
				</article>
			</main>

			<!-- Footer -->
				<footer id="footer"></footer>

		</div>

		<!-- Scripts -->
		<script src="../../../assets/js/browser.min.js" defer></script>
		<script src="../../../assets/js/breakpoints.min.js" defer></script>
		<script src="../../../assets/js/util.js" defer></script>
		<script src="../../../assets/js/site-config.js"></script>
		<script src="../../../assets/js/nav.js"></script>
		<script src="../../../assets/js/main.js" defer></script>
		<script src="../../../assets/js/footer.js" defer></script>
	</body>
</html>
